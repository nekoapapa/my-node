# 分析流行病學

### 目的:探討危險因子與疾病之間的關係

### 研究方法(設計)

- 橫斷法(不考慮時間，此時狀態)
- 縱斷法(考慮時間)
    - 前瞻法:先收集暴露危險因子資料，在收集發病資料，
        - 世代追蹤
        - 巢式病例對照
        - 病例世代追蹤
    - 回朔法:先收集發病資料，在收集暴露危險因子資料，
        - 病例對照
        - 回朔世代追蹤
        - 病例交叉

### 橫斷法

- 研究設計
    - 同時收集有無罹病，及是否暴露危險因子的資料，並做對照，**優先使用勝算比**
        
        
        |  | 有罹病(盛行率) | 未罹病 |  |
        | --- | --- | --- | --- |
        | 暴露 | A | B | A+B |
        | 未暴露 | C | D | C+D |
        
        $$
        盛行比=\frac{暴露組的盛行率}{非暴露盛行率}=\frac{\frac{A}{A+B}}{\frac{C}{C+D}}
        $$
        
        $$
        勝算比(OR)=\frac{有罹病勝算}{無罹病勝算}=\frac{\frac{A}{C}}{\frac{B}{D}}
        $$
        
- 適用情況
    - 不隨時間改變的危險因子
    - 暴露至發病時間很短
- 優缺點
    - 優:
        - 可同時調查多種疾病及危險因子，多個暴露$\iff$多個疾病
        - 便宜省時
    - 缺:
        - 暴露於疾病的時序性(先後關係)，難判別因果關係
        - 若疾病期長，產生選樣偏差，使暴露與疾病無相關性，高估暴露危險性
        - 不適用罕見疾病、稀有暴露

### 同時期世代研究

- 研究設計
    
    ![螢幕擷取畫面 2022-07-08 155514.png](%E5%88%86%E6%9E%90%E6%B5%81%E8%A1%8C%E7%97%85%E5%AD%B8%209b9ea85e072c4b1d96876e152004d4f7/%E8%9E%A2%E5%B9%95%E6%93%B7%E5%8F%96%E7%95%AB%E9%9D%A2_2022-07-08_155514.png)
    
- 研究流程
    1. 研究族群選定
        - 以是否暴露區分組別或根據其他資料如病例、血液檢測分組
        - 選擇特殊的暴露經驗者如喝酒，資料亦獲得者
    2. 設定測量標準
        - 避免資訊偏差(疾病錯分)
    3. 追蹤工作
        - 失去追蹤
        - 暴露經驗改變:以**累積暴露量**進行分組、採用**巢式病例對照中的密度取樣**
        - 人力、時間、金錢限制:使用人年、**回朔形式世代追蹤**
- 研究結果於解讀
    - 相對危險性(用於探討病因)
        
        
        |  | 新發生 | 未發生 | 總觀察人年 |  |
        | --- | --- | --- | --- | --- |
        | 暴露 | A | B | E | A+B |
        | 未暴露 | C | D | F | C+D |
        | Tatal | A+C | B+D | E+F |  |
        
        $$
        RR=\frac{暴露組的累積發生率}{非暴露組的累積發生率}=\frac{\frac{A}{A+B}}{\frac{C}{C+D}}
        $$
        
        $$
        信賴區間:e^{ln(RR)\pm\sqrt{(\frac{1}{A}-\frac{1}{A+B})+(\frac{1}{C}-\frac{1}{C+D})}}
        $$
        
        $$
        發生密度(ID)=\frac{某段時間發病人數(A)}{某段時間發病人年數(L)}=\frac{新發病人數}{可觀察人年數}=\frac{新發病人數}{可觀察人數(未退出、未發病)\times1人年+退出人數\times0.5人年+發病人數\times0.5人年}
        $$
        
        $$
        IDR=\frac{暴露組發生密度}{非暴露組發生密度}
        $$
        
        $$
        IDR信賴區間:IDR^{1\pm Z_\frac{\alpha}{2}\times\frac{1}{Z^\ast}}
        $$
        
        $$
        Z^\ast=\frac{O-np}{\sqrt{npq}}=\frac{A-(A+C)\times\frac{E}{E+F}}{\sqrt{(A+C)\times\frac{E}{E+F}\times\frac{F}{E+F}}}
        $$
        
    - 標準化發生率(SRR)
        
        $$
        標準化發生率(SRR)=\frac{標準化暴露組發生率(以非暴露組為標準)}{非暴露組發生率}=\frac{\frac{\Sigma各年齡非暴露組人數\times暴露組年齡別發生率}{非暴露組總人數}}{非暴露組發生率}
        $$
        
    - 解讀(探討病因)
        - SRR、IDR、RR=1:疾病與暴露無關
        - SRR、IDR、RR>1:為危險因
        - SRR、DR、RR<1:為保護因子
    - 相差危險性(RD)、可歸因危險性(AR)，用於疾病防治
        - AR、RD、SRD、IDD=暴露發生率(發生密度、標準化發生率)-非暴露發生率(發生密度、標準化發生率)
        - 可歸因危險比:$AF=AR\%=\frac{暴露發生率-非暴露發生率}{暴露發生率}=\frac{RR-1}{RR}$
        - 信賴區間
            
            $$
            (\hat{p}_1-\hat{p}_2)\pm Z_{\frac{\alpha}{2}}\sqrt{\frac{\hat{p}_1(1-\hat{p}_1)}{n_1}+\frac{\hat{p}_2(1-\hat{p}_2)}{n_2}}
            $$
            
        - $NNH(需要被傷害人數)=\frac{1}{AR}(取整數)$
        - 族群可歸因危險性:$PAR=p_{exp^+}\times CI_{exp^+}+p_{exp^-}\times CI_{exp^-}(全族群發生率)-CI_{exp^-}(非暴露發生率)$
        - 族群可歸因危險比$PAF=PAR\%=\frac{全族群發生率-非暴露發生率}{全族群發生率}=\frac{P(RR-1)}{P(RR-1)+1}$
- 優缺點
    - 優
        - 為觀察性研究，具時序性，最能確定因果關係
        - 暴露決定於結果發生之前，可避免記憶偏差產生錯誤分類
        - 可研究暴露對多種疾病關係，單一暴露$\iff$多個疾病
    - 缺
        - 適用於稀有暴露、不適用於罕見疾病
        - 昂貴，且因需長時間追蹤，追蹤期面臨，研究對象流失、診斷標準改變、研究對象暴露改變
        - 只能評價研究開始時，所記錄的暴露與疾病的關係

### 回朔型世代追蹤

- 研究設計:以過去的資料，如健保資料庫，將危險因子與疾病作串聯，做假想的追蹤。
    
    ![47136.jpg](%E5%88%86%E6%9E%90%E6%B5%81%E8%A1%8C%E7%97%85%E5%AD%B8%209b9ea85e072c4b1d96876e152004d4f7/47136.jpg)
    
- 優缺點
    - 優
        - 暴露決定為結果發生前，具有時序性，較能解釋因果關係
        - 當資料收集完整時，可避免錯誤分類
        - 相較同時期世代研究，效率較高，樣本易取得，便宜，可用於罕見疾病，且由於是資料，較少失去蹤的情況
        - 可研究單個暴露對多個疾病之間的關係
    - 缺
        - 只能評價研究開始時，所記錄的暴露與疾病的關係
        - 由於是過去的 紀錄及資料，會有錯誤紀錄的問題，仍會產生疾病及暴露錯誤分類的問題，且無法再回朔確認

### 病例對照

- 病例
    - 病例報告:針對單一的病例做詳細的描述，可了解罕見疾病在臨床的表現
    - 病例系列:研究罹患某種疾病的一群病患，可了解某種病於臨床上的表現
- 病例對照研究方法:選擇罹患某種疾病病患作為病例組，並選擇無罹患此種疾病的人作為對照組，並比較二組暴露史的差異
    
    ![47133.jpg](%E5%88%86%E6%9E%90%E6%B5%81%E8%A1%8C%E7%97%85%E5%AD%B8%209b9ea85e072c4b1d96876e152004d4f7/47133.jpg)
    
- 研究對象選擇
    - 病例組
        - 選擇新發生個案
        - 醫院:看病因素需與暴露無關，易發生選樣偏差([柏克森誤差](%E6%B8%AC%E9%87%8F%E6%BA%96%E7%A2%BA%E6%80%A7%208e73df5719c849d0964874cc93602a41.md))，便宜
        - 社區:選擇有病個案，避免選樣偏差，會出現資訊誤差(回憶偏差)，較貴
    - 對照組
        - 與病例組具有可比較性，如年齡性別相似
        - 醫院:無病例組疾病，看病因素與暴露無關，易產生選樣偏差([柏克森誤差](%E6%B8%AC%E9%87%8F%E6%BA%96%E7%A2%BA%E6%80%A7%208e73df5719c849d0964874cc93602a41.md))，較便宜，研究參與動機高
        - 社區:無病居民，干擾少(居住環境相同)，回應率低，成本高
- 配對法:控制干擾，增加可比較性
    - 頻率配對:
        - 先將病例組分為各層，再以分層抽樣，抽取對照組個案，使對照組與病例組於一定得的徵比例相同，如病例組男女比為1:2，對照組的男女比則須1:2
        - 優:簡易，方便，成本低
        - 缺:當分組範圍過大，會降低可比較性
    - 個別配對
        - 根據每個病例個案選擇一個或數個與之相似的對照個案，如一個50歲男性病例個案，需配對一個50歲的男性對照個案
        - 優:極具可比較性
        - 缺:過度相近，易造成過度匹配
    - 過度匹配:配對非研究疾病之[干擾因子](%E6%B8%AC%E9%87%8F%E6%BA%96%E7%A2%BA%E6%80%A7%208e73df5719c849d0964874cc93602a41.md)
- 研究結果
    - 勝算比
        
        
        |  | 有病 | 無病 |
        | --- | --- | --- |
        | 有暴露 | A | B |
        | 無暴露 | C | D |
        
        $$
        無配對勝算比(OR)=\frac{病例組勝算}{對照組勝算}=\frac{\frac{A}C{}}{\frac{B}{D}}
        $$
        
        $$
        信賴區間:e^{ln(OR)\pm Z_{\frac{\alpha}{2}}\sqrt{\frac{1}{A}+\frac{1}{B}+\frac{1}{C}+\frac{1}{D}}}
        $$
        
- 估計相對危險性(RR)
    
    $$
    勝算比(OR)\xrightarrow[罕見疾病下]{估計}相對危險性(RR)\xleftarrow[不準確]{估計}盛行率比
    $$
    
    $$
    AR\%=\frac{RR-1}{RR}\doteqdot\frac{OR-1}{OR}，RR由OR估計
    $$
    
    $$
    PAR\%\doteqdot\frac{P(OR-1)}{P(OR-1)+1}
    $$
    
    $$
    RR=\frac{\frac{A}{A+B}}{\frac{C}{C+D}}\xrightarrow[C\ll D，罕見疾病]{A\ll B}\frac{\frac{A}{B}}{\frac{C}{D}}=\frac{\frac{A}{C}}{\frac{B}{D}}=OR
    $$
    
- 結果解讀
    - OR=1,無相關
    - OR>1,危險因子
    - OR<1,保護因子
- 優缺點
    - 優
        - 相較世代研究經濟、省時
        - 不需要多個個案，適用罕見疾病
        - 單個疾病$\iff$多個暴露
    - 缺
        - 對於已發生的危險因子無可靠的紀錄，需依賴研究對象的回憶，易產生回憶偏差
        - 收集資料時易產生觀察偏差
        - 不易尋找合適的對照組

### 巢式病例對照

- 研究設計:先選定一個特定族群，於研究開始前收集此族群，年齡、血液檢體登資料，以密度取養的方式從族群中將有發病的個案作為病例組、未發病作為對照組
    
    ![47151.jpg](%E5%88%86%E6%9E%90%E6%B5%81%E8%A1%8C%E7%97%85%E5%AD%B8%209b9ea85e072c4b1d96876e152004d4f7/47151.jpg)
    
    - 密度取樣:當收集到病例，依此個案的暴露時長，配對選定對照個案
- 優缺點
    - 優
        - 成本低
        - 有病、無病來自同族群，避免選樣偏差
        - 暴露資料由一 開始收集研究對象資料評估，避免回憶偏差
        - 密度取樣:解決暴露時間不一致
    - 缺
        - 無統計效率:較不顯著

### 病例世代

- 研究設計:先選定一個特定族群，於研究開始前收集此族群，年齡、血液檢體等資料，將有發病的個案作為病例組，由族群中選定未發病作為對照組
    
    ![47152.jpg](%E5%88%86%E6%9E%90%E6%B5%81%E8%A1%8C%E7%97%85%E5%AD%B8%209b9ea85e072c4b1d96876e152004d4f7/47152.jpg)
    
- 優缺點
    - 優
        - 成本低
        - 有病、無病來自同族群，避免選樣偏差
        - 暴露資料由一 開始收集研究對象資料評估，避免回憶偏差
        - 相較巢式病例對照容易執行
    - 缺
        - 無配對追蹤時間、較不公平
        - 無統計效率:較不顯著

### 病例交叉

- 為病例對照與交叉設計的綜合型研究方法，用於暴露時間短暫，且會不斷的發生與鋪暴露的影響會在短時間內出現，如開車使用手機對車禍發生的影響，使用手機為短時間的暴露，且會重複發生，而車禍的發生，會在使用手機的當下有最大的危險性
- 主要為利用回朔的方法，比較個案於**作用時間**(罹病時間段)與**非作用時間**(未罹病的時間段)的暴露情況，每位病例組個案本身為自己的對照組，可使用多個非作用時間作為對照組
- 優缺點
    - 優
        - 每位病例組個案本身為自己的對照組，成本低，有較高的可比較性，對照組易尋找
    - 缺
        - 回憶偏差極大，個案無法詳細的記住各個時間段的暴露情況
        - 作用期與非作用期間格難定

### 生態研究

- 以族群如國家、城市為單位，研究族群的暴露資料，與族群的發生率及死亡率等指標，可做迴歸分析探討暴露與疾病的相關性，也可使用多元回歸將族群的年齡、性別結構分布，納入相關因素，進行控制分析
- 優缺點
    - 優
        - 簡單、經濟、省時
    - 缺
        - 易產生生態學誤謬，生態研究主要是以族群的資料來推估個人實際的情況，因無法取得或控制相關的干擾因子，會錯估暴露與疾病的相關性。

### 研究方法統整

|  | 橫斷法 | 同期世代追蹤 | 回朔世代追蹤 | 病例對照 |
| --- | --- | --- | --- | --- |
| 資料收集 | 同時收集罹病及暴露資料 | 暴露資料 | 罹病及暴露資料 | 病例、對照組 |
| 結果收集 | 罹病與暴露資料對照 | 罹病結果 | 對照罹病及暴露資料 | 比較病例組及對照組 |
| 結果解讀 | 盛行比、勝算比 | SRR、RR、IDR、AR | SRR、RR、IDR、AR | OR、AR%、PAR% |
| 優點 | 耗時短。簡易、便宜 | 具有時序性、避免回憶偏差 | 具時序性、不易因失去追蹤及暴露改變產生選樣偏差、便宜、可用於罕見疾病 | 便宜、適用罕見疾病 |
| 缺點 | 無法推斷時序性、疾病頎長高估危險性、不是用稀有暴露及罕見疾病 | 昂貴，研究對象師區追蹤、暴露改變、及診斷標準改變產生選樣偏差、不適用於罕見疾病 | 因資料的錯誤產生錯誤分類、 | 若無紀錄易產生回憶偏差及觀察偏差、對照組不易尋找 |
| 暴露 ，疾病 | 多個暴露對多個疾病 | 單個暴露對多個疾病 | 單個暴露對多個疾病 | 多個暴露對單個疾病 |

### 資訊偏差:錯誤分組

- 非差異性錯誤分組
    - 產生趨零偏差:使RR、OR接近1
    - 錯分方向、比例一致
    - 檢測敏感度、特異度相同
- 差異性錯誤分組
    - 產生離零偏差:使RR、OR遠離1
    - 錯分方向比例不同
    - 檢測敏感度特異度不同

### 干擾偏差

- 控制干擾偏差
    - 隨機分配
    - 限制法
    - 配對法
    - 分層校正
- Mantel-haenszel:分層校正
    - 男性
        
        $$
        \begin{array}{c:c:c:c} &有罹病&未罹病&總和\\ \hline 暴露組&a_1&b_1&a_1+b_1\\ \hline 非暴露組&c_1&d_1&c_1+d_1\\ \hline 總和&a_1+c_1&b_1+d_1&n_1  \end{array}
        $$
        
    - 女性
        
        $$
        \begin{array}{c:c:c:c} &有罹病&未罹病&總和\\ \hline 暴露組&a_2&b_2&a_2+b_2\\ \hline 非暴露組&c_2&d_2&c_2+d_2\\ \hline 總和&a_2+c_2&b_2+d_2&n_2  \end{array}
        $$
        
    - 分層校正相對危險性
        
        $$
        RR_{MH}=\frac{\frac{a_1(c_1+d_1)}{n_1}+\frac{a_2(c_2+d_2)}{n_2}}{\frac{c_1(a_1+b_1)}{n_1}+\frac{c_2(a_2+b_2)}{n_2}}
        $$
        
    - 分層校正勝算比
        
        $$
        OR_{MH}=\frac{\frac{a_1(b_1+d_1)}{n_1}+\frac{a_2(b_2+d_2)}{n_2}}{\frac{b_1(a_1+c_1)}{n_1}+\frac{b_2(a_2+c_2)}{n_2}}
        $$
        

### 交互作用

- 單個疾病會有多個危險因子，當危險因子會因為在因子的存在與否，對疾病的作用不同，此現象為交互作用、此**外在因子為修飾因子 $\rightarrow$**分層後，各層的RR、OR不同
- 干擾因子$\rightarrow$整體RR、OR未在分層後各層的RR、OR之間$\rightarrow$mantel-haenszel

$$
假設檢定:Z^*=\frac{ln(OR_1)-ln(OR_2)}{\sqrt{OR_1變異數+OR_2變異數}}
$$

- 相加性(累加)交互作用
    - 協同:$RR_{total}>(RR_1+RR_2)-1$
    - 獨立:$RR_{total}=(RR_1+RR_2)-1$
    - 拮抗:$RR_{total}<(RR_1+RR_2)-1$
- 相乘性(累乘)交互作用
    - 協同:$RR_{total}>(RR_1\times RR_2)$
    - 獨立:$RR_{total}=(RR_1\times RR_2)$
    - 拮抗:$RR_{total}<(RR_1\times RR_2)$

### 中介因子